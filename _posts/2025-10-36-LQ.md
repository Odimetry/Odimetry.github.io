---
layout: post
title: "LQR / 선형 이차 제어기"
date: 2025-10-26 12:00 +0900
tags: [test]
---
Linear-quadratic regulator
===
The case where the system dynamics are described by a set of linear differential equations and the cost is described by a quadratic function is called the LQ problem. One of the main results in the theory is that the solution is provided by the linear-quadratic regulator (LQR), a feedback controller whose equations are given below. \\
LQR controllers possess inherent robustness with guaranteed gain and phase margin, and they also are part of the solution to the LQG (linear-quadratic-Gaussian) problem. Like the LQR problem itself, the LQG problem is one of the most fundamental problems in control theory.

Versions
===
**Commons**\\
$ \mathbf{x} \in \mathbb{R}^n, \mathbf{u} \in \mathbb{R}^m $
$F$ is the terminal cost matrix, $Q$ is the state cost matrix, $R$ is the control cost matrix, and $N$ is the cross-term(control and state) cost matrix.

**Finite-horizon, continuous-time**\\
For a continuous-time linear system, defined on $ t \in [t_0, t_1]$, described by: \\
$$
\dot{x} = Ax + Bu
$$ \\
Given a quadratic cost function for the system, defined as:
$$
J = x^{T}(t_1)F(t_1)x(t_1) + \int^{t_1}_{t_0} (x^{T}Qx + u^{T}Ru + 2x^{T}Nu) dt
$$

**Infinite-horizon, continuous-time**\\
A cost function defined as: \\
$$
J = \int^{\infty}_{0} (x^{T}Qx + u^{T}Ru + 2x^{T}Nu) dt
$$

**Finite-horizon, discrete-time**\\
For a discrete-time linear system described by:\\
$$
\mathbf{x_{k+1}} = A \mathbf{x_k} + B \mathbf{u_k}
$$\\
with a performance index defined as:\\
$$
J = \mathbf{x}^{T}_{H_{P}} Q_{H_{p}} \mathbf{x}_{H_{p}} + \Sigma^{H_{p}-1}_{k=0} (\mathbf{x}^T_k Q \mathbf{x}_k + \mathbf{u}^T_k R \mathbf{u}_k+2 \mathbf{x}^T_k N \mathbf{u}_k)
$$  \\
where $H_p$ is the time horizon.

**Infinite-horizon, discrete-time**\\
For a discrete-time linear system described by:\\
$$
\mathbf{x_{k+1}} = A \mathbf{x_k} + B \mathbf{u_k}
$$\\
with a performance index defined as:\\
$$
J = \Sigma^{\infty}_{k=0} (\mathbf{x}^T_k Q \mathbf{x}_k + \mathbf{u}^T_k R \mathbf{u}_k+2 \mathbf{x}^T_k N \mathbf{u}_k)
$$

**Constraints**\\
In practice, not all values of $\mathbf{x}_k, \mathbf{u}_k$ may be allowed. One common constraint is the linear one:
$$
C \mathbf{x} + D \mathbf{u} \leq e
$$ \\
The finite horizon version of this is a convex optimization problem, and so the problem is often solved repeatedly with a receding horizon. This is a form of model prediction control.


선형 이차 제어기
===
시스템 모델이 선형 미분 방정식의 집합으로 구성되고, 비용이 이차 함수로 구성되는 경우 이를 LQ 문제라 정의한다. 이 문제의 해법 중 하나로는 LQ 제어기가 존재하는데, 다음의 공식을 따르는 피드백 제어기를 말한다. LQR 제어기는 증폭값(Gain)이 보장되어 있고 위상 변이에 대해 강건성을 가지며, 이는 LQG (선형 이차 가우시안) 문제라고 표현할 수 있다. LQ 제어기처럼 LQG 문제는 제어공학에서 가장 기초적인 영역이다.

형태들
===
**공통사항**\\
$ \mathbf{x} \in \mathbb{R}^n, \mathbf{u} \in \mathbb{R}^m $
$F$는 비용 함수를, $Q$는 상태 비용 행렬(state cost matrix)을,, $R$은 제어 비용 행렬(control cost matrix)을, 마지막으로 $N$은 제어와 상태에 대한 비용 행렬이다.

**유한 영역에서 평평하고, 시간에 대해서 연속적**\\
시간에 대해서 연속적이고 선형적인 시스템이 시간$ t \in [t_0, t_1]$에 대해서 정의된다면 \\
$$
\dot{x} = Ax + Bu
$$ \\
그리고 이 시스템의 비용 함수는
$$
J = x^{T}(t_1)F(t_1)x(t_1) + \int^{t_1}_{t_0} (x^{T}Qx + u^{T}Ru + 2x^{T}Nu) dt
$$

**무한 영역에서 평평하고, 시간에 대해서 연속적**\\
비용 함수는 다음저럼 정의된다: \\
$$
J = \int^{\infty}_{0} (x^{T}Qx + u^{T}Ru + 2x^{T}Nu) dt
$$

**유한 영역에서 평평하고, 시간에 대해서 이산적**\\
시간에 대해 이산적이고 선형을 가지는 시스템은 다음과 같이 표기한다:\\
$$
\mathbf{x_{k+1}} = A \mathbf{x_k} + B \mathbf{u_k}
$$\\
그리고 비용 함수, 혹은 성능 지표(Performance index)는 다음과 같다:\\
$$
J = \mathbf{x}^{T}_{H_{P}} Q_{H_{p}} \mathbf{x}_{H_{p}} + \Sigma^{H_{p}-1}_{k=0} (\mathbf{x}^T_k Q \mathbf{x}_k + \mathbf{u}^T_k R \mathbf{u}_k+2 \mathbf{x}^T_k N \mathbf{u}_k)
$$  \\
이때 $H_p$ 시간에 대해 평평하다(변화가 없다).

**무한 영역에서 평평하고, 시간에 대해 이산적**\\
이산 시간에서 정의된 선형 시스템은:\\
$$
\mathbf{x_{k+1}} = A \mathbf{x_k} + B \mathbf{u_k}
$$\\
그리고 성능 지표는:\\
$$
J = \Sigma^{\infty}_{k=0} (\mathbf{x}^T_k Q \mathbf{x}_k + \mathbf{u}^T_k R \mathbf{u}_k+2 \mathbf{x}^T_k N \mathbf{u}_k)
$$

**제약조건**\\
일반적으로 $\mathbf{x}_k, \mathbf{u}_k$의 모든 값은 계산이 불가능하다. 하지만 이 중에서 하나의 값을 선택했을 때 다음의 부등식을 만족한다고 가정하면
$$
C \mathbf{x} + D \mathbf{u} \leq e
$$ \\
이것은 볼록 최적화 문제의 유한-평평 문제이며, 평평한 영역을 뒤로 풀면서 자주 접하는 문제다. 이것은 MPC(model prediction control) 제어의 한 형태로 바뀐다.

